/*
Copyright (c) 2012, comScore Inc. All rights reserved.
version: 5.0.3
*/
var _halt=false;
var _reg = /^http(s)?\:\/\/www\.windowsphone\.com/i.test(document.referrer);
if(_reg){
	_halt = true;
}
function _set_SessionCookie(n, f){
  var c = n+'=' + f  	    	
  				+ '; path=/'
   			 	+ '; domain=.windowsphone.com';
	document.cookie = c;	
}

if(document.getElementById("signin") && document.getElementById("signin")!=null){
	var _login = document.getElementById("signin");
	if(_login.addEventListener){
			_login.addEventListener('click', function(event){ _set_SessionCookie("graceIncr", 1);}, false);
	}else{
			_login.attachEvent('onclick',function(){ _set_SessionCookie("graceIncr", 1);} );
	}
}
_set_SessionCookie("graceIncr", 0);

COMSCORE.SiteRecruit.Broker.config = {
	version: "5.0.3",
	//TODO:Karl extend cookie enhancements to ie userdata
		testMode: false,
	
	// cookie settings
	cookie:{
		name: 'msresearch',
		path: '/',
		domain:  '.windowsphone.com' ,
		duration: 90,
		rapidDuration: 0,
		expireDate: ''
	},
	thirdPartyOptOutCookieEnabled : true,
	thirdPartyOptOutCookie1:{
		name: 'ar_p127227702',
		path: '',
		domain: '',
		duration: 0,
		rapidDuration: 0,
		expireDate: ''
	},
	thirdPartyOptOutCookie2:{
		name: '' ,
		path: '',
		domain: '',
		duration: 0,
		rapidDuration: 0,
		expireDate: ''
	},	
	
	
	// optional prefix for pagemapping's pageconfig file
	prefixUrl: "",
	
	//events
	Events: {
		beforeRecruit: function() {
					}
	},
	
		mapping:[
	// m=regex match, c=page config file (prefixed with configUrl), f=frequency
	{m: '//[\\w\\.-]+/de-de/', c: 'inv_c_p127227702-DE.js', f: 0.035, p: 0, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-gb', c: 'inv_c_p127227702-GB.js', f: 0.0165, p: 0, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-us', c: 'inv_c_p127227702-US.js', f: 0.011, p: 0, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-us/celebrity/andy', c: 'inv_c_p127227702-US-2006.js', f: 0.04, p: 1, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-us/celebrity/cam', c: 'inv_c_p127227702-US-2007.js', f: 0.04, p: 1, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-us/celebrity/gwen', c: 'inv_c_p127227702-US-2004.js', f: 0.04, p: 1, halt: _halt 	}
	,{m: '//[\\w\\.-]+/en-us/celebrity/jessica', c: 'inv_c_p127227702-US-2005.js', f: 0.04, p: 1, halt: _halt 	}
	,{m: '//[\\w\\.-]+/fr-fr/', c: 'inv_c_p127227702-FR.js', f: 0.047, p: 0, halt: _halt 	}
]
};
COMSCORE.SiteRecruit.Broker.run();